import { Cosmetic } from "../../utils/database.js";
import { EmbedBuilder } from "discord.js";

export default {
  name: "addcosmetic",
  description: "Adiciona um banner ou √≠cone ao banco | Use: !addcosmetic {banner|icon} {nome} {url} {pre√ßo}",
  async execute(message, args) {
    if (!message.member.permissions.has("Administrator"))
      return message.reply("‚ùå Sem permiss√£o.");

    const type = args[0]?.toLowerCase(); // banner ou icon
    const name = args[1];
    const url = args[2];
    const price = parseInt(args[3]) || 0;

    if (!["banner", "icon"].includes(type)) return message.reply("‚ùå Tipo inv√°lido! Use banner ou icon.");
    if (!name || !url) return message.reply("‚ùå Use: !addcosmetic {banner|icon} {nome} {url} {pre√ßo}");

    const exists = await Cosmetic.findOne({ where: { name, type } });
    if (exists) return message.reply("‚ùå Cosm√©tico j√° existe.");

    const cosmetic = await Cosmetic.create({ name, type, url, price });

    const embed = new EmbedBuilder()
      .setTitle("üé® Cosm√©tico adicionado!")
      .setDescription(`**${cosmetic.name}** (${cosmetic.type}) adicionado ao banco.`)
      .setImage(cosmetic.url)
      .setColor("Blue");

    return message.channel.send({ embeds: [embed] });
  }
};
