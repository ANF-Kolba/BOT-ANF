import { EmbedBuilder } from "discord.js";
import { getUser, updateCoins, setDaily } from "../../utils/database.js";

export default {
  name: "daily",
  description: "Receba sua recompensa di√°ria de ANF Coins",
  async execute(message) {
    const user = await getUser(message.author.id);
    const now = Date.now();
    const diff = now - (user.lastDaily || 0);

    if (diff < 24*60*60*1000) {
      const horas = Math.floor((24*60*60*1000 - diff)/3600000);
      const minutos = Math.floor(((24*60*60*1000 - diff)%3600000)/60000);
      return message.reply(`‚è≥ Voc√™ j√° recebeu sua di√°ria! Tente novamente em ${horas}h ${minutos}m.`);
    }

    const valor = 100; // di√°rio fixo
    await updateCoins(message.author.id, valor);
    await setDaily(message.author.id, now);

    const embed = new EmbedBuilder()
      .setTitle("üí∞ Recompensa di√°ria")
      .setDescription(`${message.author} recebeu **${valor} ANF Coins**!`)
      .setColor("Green");

    message.channel.send({ embeds: [embed] });
  }
};
