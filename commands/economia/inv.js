import { EmbedBuilder } from "discord.js";
import { getInventory } from "../../utils/database.js";

export default {
  name: "inv",
  description: "Mostra seu inventÃ¡rio",
  async execute(message) {
    const items = await getInventory(message.author.id);

    if (!items.length) {
      return message.reply("ðŸ“¦ Seu inventÃ¡rio estÃ¡ vazio!");
    }

    // Separar lootboxes e cosmÃ©ticos
    const lootboxes = items.filter(i => i.item && i.item.toLowerCase() === "lootbox");
    const cosmetics = items.filter(i => i.cosmetic);

    const embed = new EmbedBuilder()
      .setTitle(`${message.author.username} â€” InventÃ¡rio`)
      .setColor("Blue")
      .addFields(
        {
          name: "ðŸ“¦ Lootboxes",
          value: lootboxes.length
            ? lootboxes.map((_, idx) => `Lootbox #${idx + 1}`).join("\n")
            : "Nenhuma",
          inline: true,
        },
        {
          name: "ðŸŽ¨ CosmÃ©ticos",
          value: cosmetics.length
            ? cosmetics.map(c => `**${c.cosmetic.name}** (${c.cosmetic.type})`).join("\n")
            : "Nenhum",
          inline: true,
        }
      );

    return message.channel.send({ embeds: [embed] });
  }
};
